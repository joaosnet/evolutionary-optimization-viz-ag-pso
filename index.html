<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AG vs PSO - Otimiza√ß√£o Evolutiva | Visualiza√ß√£o Interativa</title>
    <meta name="description"
        content="Compara√ß√£o interativa entre Algoritmos Gen√©ticos (Real-Coded) e PSO na fun√ß√£o Rastrigin">
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/recharts@2.10.3/umd/Recharts.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500&family=Space+Grotesk:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Space Grotesk', sans-serif;
        }

        :root {
            --spa-bg-start: #0f172a;
            --spa-bg-mid: #052e2b;
            --spa-bg-end: #0b1116;
            --spa-text: #f8fafc;
            --spa-muted: rgba(248, 250, 252, 0.6);
            --spa-card: rgba(15, 23, 42, 0.65);
            --spa-border: rgba(255, 255, 255, 0.12);
            --spa-wipe-light: #f7f5f2;
            --spa-wipe-dark: #0b1116;
        }

        body[data-theme="light"] {
            --spa-bg-start: #f7f5f2;
            --spa-bg-mid: #f1ece6;
            --spa-bg-end: #e6e1da;
            --spa-text: #0f172a;
            --spa-muted: rgba(15, 23, 42, 0.6);
            --spa-card: rgba(255, 255, 255, 0.7);
            --spa-border: rgba(15, 23, 42, 0.12);
        }

        .spa-body {
            min-height: 100vh;
            color: var(--spa-text);
            background: radial-gradient(circle at top left, var(--spa-bg-start), var(--spa-bg-mid), var(--spa-bg-end));
            transition: background 0.4s ease, color 0.4s ease;
        }

        code,
        pre,
        .mono {
            font-family: 'IBM Plex Mono', monospace;
        }

        .glass {
            background: var(--spa-card);
            backdrop-filter: blur(10px);
            border: 1px solid var(--spa-border);
        }

        .gradient-text {
            background: linear-gradient(135deg, #0f766e 0%, #f59e0b 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .glow {
            box-shadow: 0 0 40px rgba(15, 118, 110, 0.35);
        }

        @keyframes pulse-slow {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.7;
            }
        }

        .animate-pulse-slow {
            animation: pulse-slow 3s infinite;
        }

        .spa-toggle {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 0.9rem;
            border-radius: 999px;
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--spa-text);
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            font-size: 0.75rem;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        body[data-theme="light"] .spa-toggle {
            background: rgba(15, 23, 42, 0.05);
            border: 1px solid rgba(15, 23, 42, 0.15);
            color: #0f172a;
        }

        .spa-toggle:hover {
            transform: translateY(-1px);
            box-shadow: 0 12px 24px -18px rgba(15, 118, 110, 0.5);
        }

        .spa-toggle .toggle-icon {
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            background: rgba(15, 118, 110, 0.2);
            border: 1px solid rgba(15, 118, 110, 0.4);
            font-size: 0.9rem;
        }

        body[data-theme="light"] .spa-toggle .toggle-icon {
            background: rgba(15, 118, 110, 0.1);
        }

        .spa-theme-wipe {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 50;
            --wipe-x: 50vw;
            --wipe-y: 50vh;
            --wipe-color: var(--spa-bg-start);
        }

        .spa-theme-wipe::before {
            content: '';
            position: absolute;
            width: 200vmax;
            height: 200vmax;
            left: calc(var(--wipe-x) - 100vmax);
            top: calc(var(--wipe-y) - 100vmax);
            background: var(--wipe-color);
            border-radius: 50%;
            transform: scale(0);
            opacity: 0;
        }

        .spa-theme-wipe.is-active::before {
            animation: spa-theme-wipe 0.7s ease-in-out forwards;
        }

        @keyframes spa-theme-wipe {
            0% {
                transform: scale(0);
                opacity: 0.9;
            }
            70% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(1);
                opacity: 0;
            }
        }

        @media (prefers-reduced-motion: reduce) {
            .spa-theme-wipe.is-active::before {
                animation: none;
            }
        }

        body[data-theme="light"] .text-white {
            color: #0f172a !important;
        }

        body[data-theme="light"] .text-white\/70 {
            color: rgba(15, 23, 42, 0.7) !important;
        }

        body[data-theme="light"] .text-white\/60 {
            color: rgba(15, 23, 42, 0.6) !important;
        }

        body[data-theme="light"] .text-white\/50 {
            color: rgba(15, 23, 42, 0.5) !important;
        }

        body[data-theme="light"] .text-white\/40 {
            color: rgba(15, 23, 42, 0.4) !important;
        }

        body[data-theme="light"] .text-white\/30 {
            color: rgba(15, 23, 42, 0.3) !important;
        }

        .slide-content {
            min-height: 400px;
        }

        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #0f1921;
        }

        ::-webkit-scrollbar-thumb {
            background: #0f766e;
            border-radius: 4px;
        }
    </style>
</head>

<body class="spa-body" data-theme="dark">
    <div id="spaThemeWipe" class="spa-theme-wipe" aria-hidden="true"></div>
    <div id="root"></div>
    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;
        const RC = window.Recharts || {};
        const { LineChart = () => null, Line = () => null, XAxis = () => null, YAxis = () => null, CartesianGrid = () => null, Tooltip = () => null, Legend = () => null, ResponsiveContainer = ({ children }) => React.createElement('div', { style: { width: '100%', height: 200 } }, children) } = RC;
        const spaThemeWipe = document.getElementById('spaThemeWipe');
        const prefersReducedMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;

        // ==================== RASTRIGIN FUNCTION ====================
        const rastrigin = (x, y) => {
            const A = 10;
            return A * 2 + (x * x - A * Math.cos(2 * Math.PI * x)) + (y * y - A * Math.cos(2 * Math.PI * y));
        };

        // ==================== GENETIC ALGORITHM (Real-Coded) ====================
        class GeneticAlgorithm {
            constructor(popSize = 30, mutationRate = 0.1, crossoverRate = 0.8, bounds = [-5.12, 5.12]) {
                this.popSize = popSize;
                this.mutationRate = mutationRate;
                this.crossoverRate = crossoverRate;
                this.bounds = bounds;
                this.population = [];
                this.bestFitness = Infinity;
                this.bestPosition = [0, 0];
                this.generation = 0;
                this.history = [];
                this.init();
            }
            init() {
                this.population = Array.from({ length: this.popSize }, () => ({
                    x: Math.random() * (this.bounds[1] - this.bounds[0]) + this.bounds[0],
                    y: Math.random() * (this.bounds[1] - this.bounds[0]) + this.bounds[0],
                    fitness: Infinity
                }));
                this.evaluate();
            }
            evaluate() {
                this.population.forEach(ind => {
                    ind.fitness = rastrigin(ind.x, ind.y);
                    if (ind.fitness < this.bestFitness) {
                        this.bestFitness = ind.fitness;
                        this.bestPosition = [ind.x, ind.y];
                    }
                });
            }
            tournamentSelection(k = 3) {
                const candidates = [];
                for (let i = 0; i < k; i++) {
                    candidates.push(this.population[Math.floor(Math.random() * this.popSize)]);
                }
                return candidates.reduce((a, b) => a.fitness < b.fitness ? a : b);
            }
            blxAlphaCrossover(p1, p2, alpha = 0.5) {
                const child = { x: 0, y: 0, fitness: Infinity };
                for (const dim of ['x', 'y']) {
                    const d = Math.abs(p1[dim] - p2[dim]);
                    const min = Math.min(p1[dim], p2[dim]) - alpha * d;
                    const max = Math.max(p1[dim], p2[dim]) + alpha * d;
                    child[dim] = Math.random() * (max - min) + min;
                    child[dim] = Math.max(this.bounds[0], Math.min(this.bounds[1], child[dim]));
                }
                return child;
            }
            mutate(ind) {
                const sigma = 0.3 * (this.bounds[1] - this.bounds[0]) * Math.exp(-this.generation / 100);
                if (Math.random() < this.mutationRate) {
                    ind.x += (Math.random() * 2 - 1) * sigma;
                    ind.x = Math.max(this.bounds[0], Math.min(this.bounds[1], ind.x));
                }
                if (Math.random() < this.mutationRate) {
                    ind.y += (Math.random() * 2 - 1) * sigma;
                    ind.y = Math.max(this.bounds[0], Math.min(this.bounds[1], ind.y));
                }
            }
            step() {
                const newPop = [];
                const elite = [...this.population].sort((a, b) => a.fitness - b.fitness).slice(0, 2);
                newPop.push(...elite.map(e => ({ ...e })));
                while (newPop.length < this.popSize) {
                    const p1 = this.tournamentSelection();
                    const p2 = this.tournamentSelection();
                    let child;
                    if (Math.random() < this.crossoverRate) {
                        child = this.blxAlphaCrossover(p1, p2);
                    } else {
                        child = { ...p1, fitness: Infinity };
                    }
                    this.mutate(child);
                    newPop.push(child);
                }
                this.population = newPop;
                this.evaluate();
                this.generation++;
                this.history.push({ gen: this.generation, fitness: this.bestFitness });
            }
            reset() {
                this.bestFitness = Infinity;
                this.bestPosition = [0, 0];
                this.generation = 0;
                this.history = [];
                this.init();
            }
        }

        // ==================== PARTICLE SWARM OPTIMIZATION ====================
        class PSO {
            constructor(swarmSize = 30, w = 0.7, c1 = 1.5, c2 = 1.5, bounds = [-5.12, 5.12]) {
                this.swarmSize = swarmSize;
                this.w = w;
                this.c1 = c1;
                this.c2 = c2;
                this.bounds = bounds;
                this.particles = [];
                this.gBestPos = [0, 0];
                this.gBestFit = Infinity;
                this.iteration = 0;
                this.history = [];
                this.init();
            }
            init() {
                this.particles = Array.from({ length: this.swarmSize }, () => {
                    const x = Math.random() * (this.bounds[1] - this.bounds[0]) + this.bounds[0];
                    const y = Math.random() * (this.bounds[1] - this.bounds[0]) + this.bounds[0];
                    const fitness = rastrigin(x, y);
                    return {
                        x, y, vx: (Math.random() - 0.5) * 2, vy: (Math.random() - 0.5) * 2,
                        pBestX: x, pBestY: y, pBestFit: fitness, fitness
                    };
                });
                this.updateGBest();
            }
            updateGBest() {
                this.particles.forEach(p => {
                    if (p.fitness < this.gBestFit) {
                        this.gBestFit = p.fitness;
                        this.gBestPos = [p.x, p.y];
                    }
                });
            }
            step() {
                this.particles.forEach(p => {
                    const r1 = Math.random(), r2 = Math.random();
                    p.vx = this.w * p.vx + this.c1 * r1 * (p.pBestX - p.x) + this.c2 * r2 * (this.gBestPos[0] - p.x);
                    p.vy = this.w * p.vy + this.c1 * r1 * (p.pBestY - p.y) + this.c2 * r2 * (this.gBestPos[1] - p.y);
                    const vMax = 1;
                    p.vx = Math.max(-vMax, Math.min(vMax, p.vx));
                    p.vy = Math.max(-vMax, Math.min(vMax, p.vy));
                    p.x += p.vx;
                    p.y += p.vy;
                    p.x = Math.max(this.bounds[0], Math.min(this.bounds[1], p.x));
                    p.y = Math.max(this.bounds[0], Math.min(this.bounds[1], p.y));
                    p.fitness = rastrigin(p.x, p.y);
                    if (p.fitness < p.pBestFit) {
                        p.pBestFit = p.fitness;
                        p.pBestX = p.x;
                        p.pBestY = p.y;
                    }
                });
                this.updateGBest();
                this.iteration++;
                this.history.push({ gen: this.iteration, fitness: this.gBestFit });
            }
            reset() {
                this.gBestPos = [0, 0];
                this.gBestFit = Infinity;
                this.iteration = 0;
                this.history = [];
                this.init();
            }
        }

        // ==================== CANVAS VISUALIZATION ====================
        const RastriginCanvas = ({ ag, pso, bounds }) => {
            const canvasRef = useRef(null);
            const drawContours = useCallback((ctx, w, h) => {
                const imgData = ctx.createImageData(w, h);
                for (let py = 0; py < h; py++) {
                    for (let px = 0; px < w; px++) {
                        const x = (px / w) * (bounds[1] - bounds[0]) + bounds[0];
                        const y = ((h - py) / h) * (bounds[1] - bounds[0]) + bounds[0];
                        const z = rastrigin(x, y);
                        const norm = Math.min(1, z / 80);
                        const hue = 240 - norm * 180;
                        const [r, g, b] = hslToRgb(hue / 360, 0.7, 0.15 + norm * 0.35);
                        const idx = (py * w + px) * 4;
                        imgData.data[idx] = r; imgData.data[idx + 1] = g; imgData.data[idx + 2] = b; imgData.data[idx + 3] = 255;
                    }
                }
                ctx.putImageData(imgData, 0, 0);
            }, [bounds]);

            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas) return;
                const ctx = canvas.getContext('2d');
                const w = canvas.width, h = canvas.height;
                drawContours(ctx, w, h);
                const toCanvas = (val) => ((val - bounds[0]) / (bounds[1] - bounds[0])) * w;
                const toCanvasY = (val) => h - ((val - bounds[0]) / (bounds[1] - bounds[0])) * h;
                // Draw AG individuals
                ctx.fillStyle = '#22c55e';
                ag.population.forEach(ind => {
                    ctx.beginPath();
                    ctx.arc(toCanvas(ind.x), toCanvasY(ind.y), 5, 0, Math.PI * 2);
                    ctx.fill();
                });
                ctx.fillStyle = '#4ade80';
                ctx.beginPath();
                ctx.arc(toCanvas(ag.bestPosition[0]), toCanvasY(ag.bestPosition[1]), 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.lineWidth = 2;
                ctx.stroke();
                // Draw PSO particles
                ctx.fillStyle = '#f97316';
                pso.particles.forEach(p => {
                    ctx.beginPath();
                    ctx.arc(toCanvas(p.x), toCanvasY(p.y), 5, 0, Math.PI * 2);
                    ctx.fill();
                });
                ctx.fillStyle = '#fb923c';
                ctx.beginPath();
                ctx.arc(toCanvas(pso.gBestPos[0]), toCanvasY(pso.gBestPos[1]), 8, 0, Math.PI * 2);
                ctx.fill();
                ctx.strokeStyle = '#fff';
                ctx.stroke();
            }, [ag, pso, bounds, drawContours]);

            return <canvas ref={canvasRef} width={500} height={500} className="rounded-xl border border-white/10 glow" />;
        };

        const hslToRgb = (h, s, l) => {
            let r, g, b;
            if (s === 0) { r = g = b = l; }
            else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1; if (t > 1) t -= 1;
                    if (t < 1 / 6) return p + (q - p) * 6 * t;
                    if (t < 1 / 2) return q;
                    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;
                    return p;
                };
                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;
                r = hue2rgb(p, q, h + 1 / 3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1 / 3);
            }
            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        };

        // ==================== TRANSLATIONS ====================
        const translations = {
            pt: {
                headerTitle: "AG vs PSO",
                headerSubtitle: "Otimiza√ß√£o Evolutiva na Fun√ß√£o Rastrigin",
                tabs: ["üéÆ Simula√ß√£o", "üìä Slides", "üí¨ Meta-Log"],
                themeLabel: "Tema",
                languageLabel: "Idioma",
                simTitle: "üéØ Simula√ß√£o em Tempo Real",
                convergenceTitle: "üìà Converg√™ncia",
                controlsTitle: "‚öôÔ∏è Controles",
                speedLabel: "Velocidade",
                populationLabel: "Popula√ß√£o",
                mutationLabel: "Muta√ß√£o (AG)",
                inertiaLabel: "In√©rcia (PSO)",
                agSimTitle: "üß¨ Simula√ß√£o AG",
                psoSimTitle: "üê¶ Simula√ß√£o PSO",
                surfaceTitle: "üìä Superf√≠cie Rastrigin",
                surfaceNote: "M√≠nimo global em (0,0) = 0",
                agFlowTitle: "üîÑ Fluxo do AG",
                psoEqTitle: "üìê Equa√ß√µes do PSO",
                comparisonTitle: "‚öñÔ∏è Compara√ß√£o AG vs PSO",
                resultsTitle: "üìä Resultados Experimentais",
                rastriginTitle: "üìä Fun√ß√£o Rastrigin",
                agTitle: "üß¨ Algoritmo Gen√©tico",
                psoTitle: "üê¶ PSO",
                metaTitle: "üí¨ Meta-Log de Prompts (Uso de IA)",
                resultsAverage: "Resultados M√©dios (30 execu√ß√µes)",
                iterationsNote: "Itera√ß√µes para atingir fitness < 0.01",
                convergenceHint: "Execute a simula√ß√£o na aba principal para ver dados reais",
                genLabel: "Gen",
                iterLabel: "Iter",
                agLabel: "üß¨ AG:",
                psoLabel: "üê¶ PSO:",
                start: "‚ñ∂ Iniciar",
                pause: "‚è∏ Pausar",
                iterationLabel: "Itera√ß√£o",
                fitnessLabel: "Fitness",
                rastriginDetails: "f(x) = An + Œ£[x·µ¢¬≤ - A¬∑cos(2œÄx·µ¢)]\n\n‚Ä¢ A = 10\n‚Ä¢ Dom√≠nio: [-5.12, 5.12]\n‚Ä¢ M√≠nimo: f(0,0) = 0\n‚Ä¢ Altamente multimodal",
                gaDetails: "‚Ä¢ Representa√ß√£o Real\n‚Ä¢ Sele√ß√£o Torneio (k=3)\n‚Ä¢ Crossover BLX-Œ± (Œ±=0.5)\n‚Ä¢ Muta√ß√£o Gaussiana\n‚Ä¢ Elitismo (2 melhores)",
                psoDetails: "‚Ä¢ In√©rcia w = 0.7\n‚Ä¢ Cognitivo c‚ÇÅ = 1.5\n‚Ä¢ Social c‚ÇÇ = 1.5\n‚Ä¢ v‚Çò‚Çê‚Çì = 1.0\n‚Ä¢ pBest + gBest",
                footer: "T√≥picos Especiais em Engenharia de Computa√ß√£o III ‚Ä¢ 2026",
                flow: {
                    init: "Inicializa√ß√£o",
                    fitness: "Avalia√ß√£o Fitness",
                    tournament: "Sele√ß√£o por Torneio",
                    crossover: "Crossover BLX-Œ±",
                    mutation: "Muta√ß√£o Gaussiana",
                    elitism: "Elitismo"
                },
                psoEq: {
                    velocity: "Velocidade:",
                    position: "Posi√ß√£o:",
                    inertia: "in√©rcia (0.7)",
                    cognitive: "coef. cognitivo (1.5)",
                    social: "coef. social (1.5)"
                },
                comparison: {
                    criteria: "Crit√©rio",
                    ag: "AG",
                    pso: "PSO",
                    rows: [
                        ["Velocidade", "M√©dia", "R√°pida ‚≠ê"],
                        ["Diversidade", "Alta ‚≠ê", "M√©dia"],
                        ["Escape √ìt. Locais", "Bom ‚≠ê", "M√©dio"],
                        ["Par√¢metros", "Muitos", "Poucos ‚≠ê"],
                        ["Implementa√ß√£o", "Complexa", "Simples ‚≠ê"],
                        ["Converg√™ncia", "Est√°vel", "Pode prematurar"]
                    ]
                },
                results: {
                    average: "Resultados M√©dios (30 execu√ß√µes)",
                    ag: "AG",
                    pso: "PSO",
                    agIters: "~85 iter",
                    psoIters: "~60 iter",
                    iterationsNote: "Itera√ß√µes para atingir fitness < 0.01",
                    successAg: "Taxa de Sucesso AG",
                    successAgValue: "97%",
                    successPso: "Taxa de Sucesso PSO",
                    successPsoValue: "94%"
                },
                slides: [
                    { title: "Otimiza√ß√£o Evolutiva", subtitle: "AG vs PSO na Fun√ß√£o Rastrigin", content: "Trabalho pr√°tico de T√≥picos Especiais em Engenharia de Computa√ß√£o III", icon: "üß¨", type: "title" },
                    { title: "Fun√ß√£o Rastrigin", content: "f(x) = An + Œ£[x·µ¢¬≤ - A¬∑cos(2œÄx·µ¢)]\n\n‚Ä¢ Altamente multimodal\n‚Ä¢ √ìtimo global em (0,0) = 0\n‚Ä¢ Dom√≠nio: [-5.12, 5.12]", icon: "üìä", type: "text" },
                    { title: "Superf√≠cie Rastrigin 2D", type: "rastrigin2d" },
                    { title: "Curvas de N√≠vel", type: "contour" },
                    { title: "Algoritmo Gen√©tico (AG)", content: "‚Ä¢ Representa√ß√£o Real (n√£o bin√°ria)\n‚Ä¢ Sele√ß√£o por Torneio (k=3)\n‚Ä¢ Crossover BLX-Œ± (Œ±=0.5)\n‚Ä¢ Muta√ß√£o Gaussiana Adaptativa\n‚Ä¢ Elitismo (2 melhores)", icon: "üß¨", type: "text" },
                    { title: "Fluxo do AG", type: "agflow" },
                    { title: "PSO - Particle Swarm", content: "‚Ä¢ Inspirado em bandos de p√°ssaros\n‚Ä¢ Velocidade + Posi√ß√£o\n‚Ä¢ pBest (mem√≥ria individual)\n‚Ä¢ gBest (melhor global)\n‚Ä¢ Par√¢metros: w, c1, c2", icon: "üê¶", type: "text" },
                    { title: "Equa√ß√µes do PSO", type: "psoequations" },
                    { title: "Simula√ß√£o AG", type: "simAG" },
                    { title: "Simula√ß√£o PSO", type: "simPSO" },
                    { title: "Gr√°fico de Converg√™ncia", type: "convergence" },
                    { title: "Compara√ß√£o AG vs PSO", type: "comparison" },
                    { title: "Resultados Experimentais", type: "results" },
                    { title: "Conclus√µes", content: "‚Ä¢ Ambos convergem para (0,0)\n‚Ä¢ PSO geralmente mais r√°pido\n‚Ä¢ AG mais robusto em multimodais\n‚Ä¢ Hibridiza√ß√£o √© promissora\n‚Ä¢ Escolha depende do problema", icon: "üéØ", type: "text" }
                ],
                metaPrompts: [
                    { role: "User", content: "Preciso criar uma SPA que compare AG e PSO na fun√ß√£o Rastrigin com visualiza√ß√£o Canvas." },
                    { role: "AI", content: "Vou implementar: 1) Classes GA e PSO em JS 2) Canvas com curvas de n√≠vel 3) Recharts para converg√™ncia 4) UI com Tailwind" },
                    { role: "User", content: "Adiciona um sistema de slides para apresenta√ß√£o e gera o relat√≥rio LaTeX no formato SBC." },
                    { role: "AI", content: "Implementei slides interativos com navega√ß√£o e template LaTeX SBC completo com equa√ß√µes." },
                    { role: "User", content: "Preciso de um README.md profissional com badges e SEO para GitHub." },
                    { role: "AI", content: "Gerei README com badges din√¢micos, instru√ß√µes de uso, e sugeri topics para SEO do reposit√≥rio." }
                ]
            },
            en: {
                headerTitle: "AG vs PSO",
                headerSubtitle: "Evolutionary Optimization on the Rastrigin Function",
                tabs: ["üéÆ Simulation", "üìä Slides", "üí¨ Meta-Log"],
                themeLabel: "Theme",
                languageLabel: "Language",
                simTitle: "üéØ Real-Time Simulation",
                convergenceTitle: "üìà Convergence",
                controlsTitle: "‚öôÔ∏è Controls",
                speedLabel: "Speed",
                populationLabel: "Population",
                mutationLabel: "Mutation (GA)",
                inertiaLabel: "Inertia (PSO)",
                agSimTitle: "üß¨ GA Simulation",
                psoSimTitle: "üê¶ PSO Simulation",
                surfaceTitle: "üìä Rastrigin Surface",
                surfaceNote: "Global minimum at (0,0) = 0",
                agFlowTitle: "üîÑ GA Flow",
                psoEqTitle: "üìê PSO Equations",
                comparisonTitle: "‚öñÔ∏è GA vs PSO Comparison",
                resultsTitle: "üìä Experimental Results",
                rastriginTitle: "üìä Rastrigin Function",
                agTitle: "üß¨ Genetic Algorithm",
                psoTitle: "üê¶ PSO",
                metaTitle: "üí¨ Prompt Meta-Log (AI Usage)",
                resultsAverage: "Average Results (30 runs)",
                iterationsNote: "Iterations to reach fitness < 0.01",
                convergenceHint: "Run the simulation in the main tab to see real data",
                genLabel: "Gen",
                iterLabel: "Iter",
                agLabel: "üß¨ GA:",
                psoLabel: "üê¶ PSO:",
                start: "‚ñ∂ Start",
                pause: "‚è∏ Pause",
                iterationLabel: "Iteration",
                fitnessLabel: "Fitness",
                rastriginDetails: "f(x) = An + Œ£[x·µ¢¬≤ - A¬∑cos(2œÄx·µ¢)]\n\n‚Ä¢ A = 10\n‚Ä¢ Domain: [-5.12, 5.12]\n‚Ä¢ Minimum: f(0,0) = 0\n‚Ä¢ Highly multimodal",
                gaDetails: "‚Ä¢ Real-coded representation\n‚Ä¢ Tournament selection (k=3)\n‚Ä¢ BLX-Œ± crossover (Œ±=0.5)\n‚Ä¢ Gaussian mutation\n‚Ä¢ Elitism (top 2)",
                psoDetails: "‚Ä¢ Inertia w = 0.7\n‚Ä¢ Cognitive c‚ÇÅ = 1.5\n‚Ä¢ Social c‚ÇÇ = 1.5\n‚Ä¢ v‚Çò‚Çê‚Çì = 1.0\n‚Ä¢ pBest + gBest",
                footer: "Special Topics in Computer Engineering III ‚Ä¢ 2026",
                flow: {
                    init: "Initialization",
                    fitness: "Fitness Evaluation",
                    tournament: "Tournament Selection",
                    crossover: "BLX-Œ± Crossover",
                    mutation: "Gaussian Mutation",
                    elitism: "Elitism"
                },
                psoEq: {
                    velocity: "Velocity:",
                    position: "Position:",
                    inertia: "inertia (0.7)",
                    cognitive: "cognitive coef. (1.5)",
                    social: "social coef. (1.5)"
                },
                comparison: {
                    criteria: "Criteria",
                    ag: "GA",
                    pso: "PSO",
                    rows: [
                        ["Speed", "Medium", "Fast ‚≠ê"],
                        ["Diversity", "High ‚≠ê", "Medium"],
                        ["Escape Local Optima", "Good ‚≠ê", "Average"],
                        ["Parameters", "Many", "Few ‚≠ê"],
                        ["Implementation", "Complex", "Simple ‚≠ê"],
                        ["Convergence", "Stable", "May be premature"]
                    ]
                },
                results: {
                    average: "Average Results (30 runs)",
                    ag: "GA",
                    pso: "PSO",
                    agIters: "~85 iter",
                    psoIters: "~60 iter",
                    iterationsNote: "Iterations to reach fitness < 0.01",
                    successAg: "GA Success Rate",
                    successAgValue: "97%",
                    successPso: "PSO Success Rate",
                    successPsoValue: "94%"
                },
                slides: [
                    { title: "Evolutionary Optimization", subtitle: "GA vs PSO on the Rastrigin Function", content: "Practical assignment for Special Topics in Computer Engineering III", icon: "üß¨", type: "title" },
                    { title: "Rastrigin Function", content: "f(x) = An + Œ£[x·µ¢¬≤ - A¬∑cos(2œÄx·µ¢)]\n\n‚Ä¢ Highly multimodal\n‚Ä¢ Global minimum at (0,0) = 0\n‚Ä¢ Domain: [-5.12, 5.12]", icon: "üìä", type: "text" },
                    { title: "Rastrigin Surface 2D", type: "rastrigin2d" },
                    { title: "Contour Lines", type: "contour" },
                    { title: "Genetic Algorithm (GA)", content: "‚Ä¢ Real-coded representation\n‚Ä¢ Tournament selection (k=3)\n‚Ä¢ BLX-Œ± crossover (Œ±=0.5)\n‚Ä¢ Adaptive Gaussian mutation\n‚Ä¢ Elitism (top 2)", icon: "üß¨", type: "text" },
                    { title: "GA Flow", type: "agflow" },
                    { title: "PSO - Particle Swarm", content: "‚Ä¢ Inspired by bird flocks\n‚Ä¢ Velocity + Position\n‚Ä¢ pBest (individual memory)\n‚Ä¢ gBest (global best)\n‚Ä¢ Parameters: w, c1, c2", icon: "üê¶", type: "text" },
                    { title: "PSO Equations", type: "psoequations" },
                    { title: "GA Simulation", type: "simAG" },
                    { title: "PSO Simulation", type: "simPSO" },
                    { title: "Convergence Plot", type: "convergence" },
                    { title: "GA vs PSO Comparison", type: "comparison" },
                    { title: "Experimental Results", type: "results" },
                    { title: "Conclusions", content: "‚Ä¢ Both converge to (0,0)\n‚Ä¢ PSO is usually faster\n‚Ä¢ GA is more robust in multimodal landscapes\n‚Ä¢ Hybridization is promising\n‚Ä¢ Choice depends on the problem", icon: "üéØ", type: "text" }
                ],
                metaPrompts: [
                    { role: "User", content: "I need a SPA that compares GA and PSO on the Rastrigin function with Canvas visualization." },
                    { role: "AI", content: "I will implement: 1) GA and PSO classes in JS 2) Canvas contour plots 3) Recharts convergence 4) UI with Tailwind" },
                    { role: "User", content: "Add a slide system for presentation and generate the SBC LaTeX report." },
                    { role: "AI", content: "I implemented interactive slides with navigation and a full SBC LaTeX template with equations." },
                    { role: "User", content: "I need a professional README with badges and SEO for GitHub." },
                    { role: "AI", content: "I generated a README with dynamic badges, usage instructions, and suggested repo topics." }
                ]
            }
        };

        // ==================== SLIDE CANVAS COMPONENTS ====================
        const RastriginMiniCanvas = ({ showAG = false, showPSO = false, ag, pso }) => {
            const canvasRef = useRef(null);
            const bounds = [-5.12, 5.12];
            useEffect(() => {
                const canvas = canvasRef.current;
                if (!canvas) return;
                const ctx = canvas.getContext('2d');
                const w = canvas.width, h = canvas.height;
                const imgData = ctx.createImageData(w, h);
                for (let py = 0; py < h; py++) {
                    for (let px = 0; px < w; px++) {
                        const x = (px / w) * (bounds[1] - bounds[0]) + bounds[0];
                        const y = ((h - py) / h) * (bounds[1] - bounds[0]) + bounds[0];
                        const z = rastrigin(x, y);
                        const norm = Math.min(1, z / 80);
                        const hue = 240 - norm * 180;
                        const [r, g, b] = hslToRgb(hue / 360, 0.7, 0.15 + norm * 0.35);
                        const idx = (py * w + px) * 4;
                        imgData.data[idx] = r; imgData.data[idx + 1] = g; imgData.data[idx + 2] = b; imgData.data[idx + 3] = 255;
                    }
                }
                ctx.putImageData(imgData, 0, 0);
                const toCanvas = (val) => ((val - bounds[0]) / (bounds[1] - bounds[0])) * w;
                const toCanvasY = (val) => h - ((val - bounds[0]) / (bounds[1] - bounds[0])) * h;
                if (showAG && ag) {
                    ctx.fillStyle = '#22c55e';
                    ag.population.forEach(ind => { ctx.beginPath(); ctx.arc(toCanvas(ind.x), toCanvasY(ind.y), 4, 0, Math.PI * 2); ctx.fill(); });
                }
                if (showPSO && pso) {
                    ctx.fillStyle = '#f97316';
                    pso.particles.forEach(p => { ctx.beginPath(); ctx.arc(toCanvas(p.x), toCanvasY(p.y), 4, 0, Math.PI * 2); ctx.fill(); });
                }
            }, [showAG, showPSO, ag, pso]);
            return <canvas ref={canvasRef} width={300} height={300} className="rounded-xl border border-white/20" />;
        };

        const FlowchartAG = ({ labels }) => (
            <div className="flex flex-col items-center gap-2 text-sm">
                <div className="bg-green-600 px-4 py-2 rounded-lg font-bold">{labels.init}</div>
                <div className="text-2xl">‚Üì</div>
                <div className="bg-green-700 px-4 py-2 rounded-lg">{labels.fitness}</div>
                <div className="text-2xl">‚Üì</div>
                <div className="bg-green-600 px-4 py-2 rounded-lg">{labels.tournament}</div>
                <div className="text-2xl">‚Üì</div>
                <div className="bg-green-700 px-4 py-2 rounded-lg">{labels.crossover}</div>
                <div className="text-2xl">‚Üì</div>
                <div className="bg-green-600 px-4 py-2 rounded-lg">{labels.mutation}</div>
                <div className="text-2xl">‚Üì</div>
                <div className="bg-green-700 px-4 py-2 rounded-lg">{labels.elitism}</div>
                <div className="text-2xl">‚Üª</div>
            </div>
        );

        const PSOEquations = ({ labels }) => (
            <div className="text-left space-y-6 font-mono text-lg">
                <div className="bg-slate-800 p-4 rounded-xl">
                    <p className="text-orange-400 font-bold mb-2">{labels.velocity}</p>
                    <p className="text-white">v<sub>i</sub><sup>t+1</sup> = w¬∑v<sub>i</sub><sup>t</sup> + c‚ÇÅr‚ÇÅ(pBest - x<sub>i</sub>) + c‚ÇÇr‚ÇÇ(gBest - x<sub>i</sub>)</p>
                </div>
                <div className="bg-slate-800 p-4 rounded-xl">
                    <p className="text-orange-400 font-bold mb-2">{labels.position}</p>
                    <p className="text-white">x<sub>i</sub><sup>t+1</sup> = x<sub>i</sub><sup>t</sup> + v<sub>i</sub><sup>t+1</sup></p>
                </div>
                <div className="bg-slate-700 p-4 rounded-xl text-sm">
                    <p><span className="text-amber-400">w</span> = {labels.inertia}</p>
                    <p><span className="text-amber-400">c‚ÇÅ</span> = {labels.cognitive}</p>
                    <p><span className="text-amber-400">c‚ÇÇ</span> = {labels.social}</p>
                </div>
            </div>
        );

        const ComparisonTable = ({ labels }) => (
            <table className="w-full text-left border-collapse">
                <thead>
                    <tr className="border-b border-white/20">
                        <th className="p-3">{labels.criteria}</th>
                        <th className="p-3 text-green-400">{labels.ag}</th>
                        <th className="p-3 text-orange-400">{labels.pso}</th>
                    </tr>
                </thead>
                <tbody className="text-sm">
                    {labels.rows.map((row, idx) => (
                        <tr key={idx} className={idx < labels.rows.length - 1 ? "border-b border-white/10" : ""}>
                            <td className="p-3">{row[0]}</td>
                            <td className="p-3">{row[1]}</td>
                            <td className="p-3">{row[2]}</td>
                        </tr>
                    ))}
                </tbody>
            </table>
        );

        const ResultsChart = ({ labels }) => (
            <div className="space-y-4">
                <div className="text-center mb-4 font-bold">{labels.average}</div>
                <div className="flex items-end justify-center gap-8 h-48">
                    <div className="flex flex-col items-center">
                        <div className="bg-green-500 w-16 rounded-t" style={{ height: '140px' }}></div>
                        <span className="mt-2 text-sm">{labels.ag}</span>
                        <span className="text-xs text-white/50">{labels.agIters}</span>
                    </div>
                    <div className="flex flex-col items-center">
                        <div className="bg-orange-500 w-16 rounded-t" style={{ height: '100px' }}></div>
                        <span className="mt-2 text-sm">{labels.pso}</span>
                        <span className="text-xs text-white/50">{labels.psoIters}</span>
                    </div>
                </div>
                <div className="text-center text-sm text-white/50">{labels.iterationsNote}</div>
                <div className="grid grid-cols-2 gap-4 mt-6 text-sm">
                    <div className="bg-green-900/30 p-3 rounded-lg text-center">
                        <div className="text-green-400 font-bold">{labels.successAg}</div>
                        <div className="text-2xl">{labels.successAgValue}</div>
                    </div>
                    <div className="bg-orange-900/30 p-3 rounded-lg text-center">
                        <div className="text-orange-400 font-bold">{labels.successPso}</div>
                        <div className="text-2xl">{labels.successPsoValue}</div>
                    </div>
                </div>
            </div>
        );


        // ==================== MAIN APP ====================
        const App = () => {
            const [theme, setTheme] = useState(() => localStorage.getItem('spa-theme') || 'dark');
            const [lang, setLang] = useState(() => localStorage.getItem('spa-lang') || 'pt');
            const [tab, setTab] = useState(0);
            const [running, setRunning] = useState(false);
            const [slideIdx, setSlideIdx] = useState(0);
            const [speed, setSpeed] = useState(100);
            const [popSize, setPopSize] = useState(30);
            const [mutRate, setMutRate] = useState(0.1);
            const [inertia, setInertia] = useState(0.7);
            const [c1, setC1] = useState(1.5);
            const [c2, setC2] = useState(1.5);
            const bounds = [-5.12, 5.12];
            const [ag, setAg] = useState(() => new GeneticAlgorithm(popSize, mutRate, 0.8, bounds));
            const [pso, setPso] = useState(() => new PSO(popSize, inertia, c1, c2, bounds));
            const [, forceUpdate] = useState(0);
            const copy = translations[lang] || translations.pt;
            const t = (key) => copy[key] || key;
            const tabs = copy.tabs;
            const slidesData = copy.slides;
            const metaPrompts = copy.metaPrompts;

            useEffect(() => {
                document.body.setAttribute('data-theme', theme);
                localStorage.setItem('spa-theme', theme);
            }, [theme]);

            useEffect(() => {
                document.documentElement.lang = lang === 'pt' ? 'pt-BR' : 'en';
                localStorage.setItem('spa-lang', lang);
            }, [lang]);

            useEffect(() => {
                if (!running) return;
                const id = setInterval(() => {
                    ag.step(); pso.step();
                    forceUpdate(n => n + 1);
                }, speed);
                return () => clearInterval(id);
            }, [running, speed, ag, pso]);

            const reset = () => {
                setRunning(false);
                const newAg = new GeneticAlgorithm(popSize, mutRate, 0.8, bounds);
                const newPso = new PSO(popSize, inertia, c1, c2, bounds);
                setAg(newAg); setPso(newPso);
            };

            const handleLanguageToggle = () => {
                setLang((prev) => (prev === 'pt' ? 'en' : 'pt'));
            };

            const handleThemeToggle = (event) => {
                const nextTheme = theme === 'dark' ? 'light' : 'dark';
                if (prefersReducedMotion || !spaThemeWipe) {
                    setTheme(nextTheme);
                    return;
                }

                const source = event?.currentTarget;
                const rect = source ? source.getBoundingClientRect() : null;
                const centerX = rect ? rect.left + rect.width / 2 : window.innerWidth / 2;
                const centerY = rect ? rect.top + rect.height / 2 : window.innerHeight / 2;
                const wipeColor = nextTheme === 'dark'
                    ? getComputedStyle(document.documentElement).getPropertyValue('--spa-wipe-dark').trim()
                    : getComputedStyle(document.documentElement).getPropertyValue('--spa-wipe-light').trim();

                spaThemeWipe.style.setProperty('--wipe-x', `${centerX}px`);
                spaThemeWipe.style.setProperty('--wipe-y', `${centerY}px`);
                spaThemeWipe.style.setProperty('--wipe-color', wipeColor || (nextTheme === 'dark' ? '#0b1116' : '#f7f5f2'));

                spaThemeWipe.classList.remove('is-active');
                void spaThemeWipe.offsetWidth;
                spaThemeWipe.classList.add('is-active');

                window.setTimeout(() => setTheme(nextTheme), 180);
                window.setTimeout(() => spaThemeWipe.classList.remove('is-active'), 720);
            };

            const chartData = ag.history.map((h, i) => ({
                gen: h.gen,
                AG: h.fitness.toFixed(4),
                PSO: pso.history[i]?.fitness.toFixed(4) || 0
            }));

            return (
                <div className="min-h-screen p-4 md:p-8">
                    <header className="text-center mb-8">
                        <h1 className="text-4xl md:text-5xl font-bold gradient-text mb-2">{t('headerTitle')}</h1>
                        <p className="text-white/60">{t('headerSubtitle')}</p>
                        <div className="flex flex-wrap justify-center gap-3 mt-4">
                            <button className="spa-toggle" onClick={handleLanguageToggle}>
                                <span className="toggle-icon">üåê</span>
                                <span>{`${t('languageLabel')} ${lang === 'pt' ? 'EN' : 'PT'}`}</span>
                            </button>
                            <button className="spa-toggle" onClick={handleThemeToggle}>
                                <span className="toggle-icon">{theme === 'dark' ? 'üåô' : '‚òÄÔ∏è'}</span>
                                <span>{t('themeLabel')}</span>
                            </button>
                        </div>
                    </header>

                    <nav className="flex flex-wrap justify-center gap-2 mb-8">
                        {tabs.map((t, i) => (
                            <button key={i} onClick={() => setTab(i)}
                                className={`px-4 py-2 rounded-lg font-medium transition-all ${tab === i ? 'bg-emerald-600 text-white glow' : 'glass text-white/70 hover:text-white'}`}>
                                {t}
                            </button>
                        ))}
                    </nav>

                    <main className="max-w-7xl mx-auto">
                        {tab === 0 && (
                            <div className="space-y-6">
                                {/* Row 1: Main simulation + Controls */}
                                <div className="grid lg:grid-cols-3 gap-6">
                                    <div className="lg:col-span-2 glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-4">{t('simTitle')}</h3>
                                        <div className="flex flex-col md:flex-row gap-6">
                                            <RastriginCanvas ag={ag} pso={pso} bounds={bounds} />
                                            <div className="flex-1">
                                                <h4 className="font-semibold mb-2">{t('convergenceTitle')}</h4>
                                                <ResponsiveContainer width="100%" height={180}>
                                                    <LineChart data={chartData}>
                                                        <CartesianGrid strokeDasharray="3 3" stroke="#444" />
                                                        <XAxis dataKey="gen" stroke="#888" />
                                                        <YAxis stroke="#888" />
                                                        <Tooltip contentStyle={{ background: '#1a1a2e', border: 'none' }} />
                                                        <Legend />
                                                        <Line type="monotone" dataKey="AG" stroke="#22c55e" dot={false} strokeWidth={2} />
                                                        <Line type="monotone" dataKey="PSO" stroke="#f97316" dot={false} strokeWidth={2} />
                                                    </LineChart>
                                                </ResponsiveContainer>
                                                <div className="mt-4 grid grid-cols-2 gap-4 text-sm">
                                                    <div className="glass p-3 rounded-lg">
                                                        <span className="text-green-400">{t('agLabel')}</span> {ag.bestFitness.toFixed(6)}
                                                        <br /><span className="text-white/50">{t('genLabel')}: {ag.generation}</span>
                                                    </div>
                                                    <div className="glass p-3 rounded-lg">
                                                        <span className="text-orange-400">{t('psoLabel')}</span> {pso.gBestFit.toFixed(6)}
                                                        <br /><span className="text-white/50">{t('iterLabel')}: {pso.iteration}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div className="glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-4">{t('controlsTitle')}</h3>
                                        <div className="space-y-3">
                                            <div className="flex gap-2">
                                                <button onClick={() => setRunning(!running)} className={`flex-1 py-2 rounded-lg font-medium ${running ? 'bg-red-500' : 'bg-green-500'}`}>
                                                    {running ? t('pause') : t('start')}
                                                </button>
                                                <button onClick={reset} className="px-4 py-2 rounded-lg bg-slate-600">üîÑ</button>
                                            </div>
                                            <label className="block"><span className="text-xs text-white/60">{t('speedLabel')}: {speed}ms</span>
                                                <input type="range" min="10" max="500" value={speed} onChange={e => setSpeed(+e.target.value)} className="w-full" />
                                            </label>
                                            <label className="block"><span className="text-xs text-white/60">{t('populationLabel')}: {popSize}</span>
                                                <input type="range" min="10" max="100" value={popSize} onChange={e => setPopSize(+e.target.value)} className="w-full" />
                                            </label>
                                            <label className="block"><span className="text-xs text-white/60">{t('mutationLabel')}: {mutRate}</span>
                                                <input type="range" min="0" max="1" step="0.05" value={mutRate} onChange={e => setMutRate(+e.target.value)} className="w-full" />
                                            </label>
                                            <label className="block"><span className="text-xs text-white/60">{t('inertiaLabel')}: {inertia}</span>
                                                <input type="range" min="0" max="1" step="0.05" value={inertia} onChange={e => setInertia(+e.target.value)} className="w-full" />
                                            </label>
                                            <div className="grid grid-cols-2 gap-2">
                                                <label className="block"><span className="text-xs text-white/60">c1: {c1}</span>
                                                    <input type="range" min="0" max="3" step="0.1" value={c1} onChange={e => setC1(+e.target.value)} className="w-full" />
                                                </label>
                                                <label className="block"><span className="text-xs text-white/60">c2: {c2}</span>
                                                    <input type="range" min="0" max="3" step="0.1" value={c2} onChange={e => setC2(+e.target.value)} className="w-full" />
                                                </label>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                {/* Row 2: Individual algorithm views */}
                                <div className="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                                    <div className="glass rounded-2xl p-6 text-center">
                                        <h3 className="font-semibold mb-4 text-green-400">{t('agSimTitle')}</h3>
                                        <RastriginMiniCanvas showAG={true} ag={ag} />
                                        <p className="mt-2 text-sm text-white/50">{t('genLabel')}: {ag.generation} | Fitness: {ag.bestFitness.toFixed(4)}</p>
                                    </div>
                                    <div className="glass rounded-2xl p-6 text-center">
                                        <h3 className="font-semibold mb-4 text-orange-400">{t('psoSimTitle')}</h3>
                                        <RastriginMiniCanvas showPSO={true} pso={pso} />
                                        <p className="mt-2 text-sm text-white/50">{t('iterLabel')}: {pso.iteration} | Fitness: {pso.gBestFit.toFixed(4)}</p>
                                    </div>
                                    <div className="glass rounded-2xl p-6 text-center">
                                        <h3 className="font-semibold mb-4">{t('surfaceTitle')}</h3>
                                        <RastriginMiniCanvas />
                                        <p className="mt-2 text-sm text-white/50">{t('surfaceNote')}</p>
                                    </div>
                                </div>

                                {/* Row 3: Flowcharts and Equations */}
                                <div className="grid md:grid-cols-2 gap-6">
                                    <div className="glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-4 text-center text-green-400">{t('agFlowTitle')}</h3>
                                        <FlowchartAG labels={copy.flow} />
                                    </div>
                                    <div className="glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-4 text-center text-orange-400">{t('psoEqTitle')}</h3>
                                        <PSOEquations labels={copy.psoEq} />
                                    </div>
                                </div>

                                {/* Row 4: Comparison and Results */}
                                <div className="grid md:grid-cols-2 gap-6">
                                    <div className="glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-4 text-center">{t('comparisonTitle')}</h3>
                                        <ComparisonTable labels={copy.comparison} />
                                    </div>
                                    <div className="glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-4 text-center">{t('resultsTitle')}</h3>
                                        <ResultsChart labels={copy.results} />
                                    </div>
                                </div>

                                {/* Row 5: Theory cards */}
                                <div className="grid md:grid-cols-3 gap-6">
                                    <div className="glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-3 gradient-text">{t('rastriginTitle')}</h3>
                                        <pre className="text-sm text-white/70 whitespace-pre-wrap">{t('rastriginDetails')}</pre>
                                    </div>
                                    <div className="glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-3 text-green-400">{t('agTitle')}</h3>
                                        <pre className="text-sm text-white/70 whitespace-pre-wrap">{t('gaDetails')}</pre>
                                    </div>
                                    <div className="glass rounded-2xl p-6">
                                        <h3 className="font-semibold mb-3 text-orange-400">{t('psoTitle')}</h3>
                                        <pre className="text-sm text-white/70 whitespace-pre-wrap">{t('psoDetails')}</pre>
                                    </div>
                                </div>
                            </div>
                        )}

                        {tab === 1 && (
                            <div className="glass rounded-2xl p-8 max-w-4xl mx-auto">
                                <div className="slide-content flex flex-col items-center justify-center text-center min-h-[450px]">
                                    <h2 className="text-3xl font-bold gradient-text mb-6">{slidesData[slideIdx].title}</h2>

                                    {/* Title/Text slides */}
                                    {(slidesData[slideIdx].type === 'title' || slidesData[slideIdx].type === 'text') && (
                                        <>
                                            {slidesData[slideIdx].icon && <span className="text-6xl mb-4">{slidesData[slideIdx].icon}</span>}
                                            {slidesData[slideIdx].subtitle && <p className="text-xl text-white/70 mb-4">{slidesData[slideIdx].subtitle}</p>}
                                            {slidesData[slideIdx].content && <pre className="text-left text-white/80 whitespace-pre-wrap max-w-2xl">{slidesData[slideIdx].content}</pre>}
                                        </>
                                    )}

                                    {/* Rastrigin 2D Surface */}
                                    {slidesData[slideIdx].type === 'rastrigin2d' && (
                                        <div className="flex flex-col items-center">
                                            <RastriginMiniCanvas />
                                            <p className="mt-4 text-white/60">Mapa de calor da fun√ß√£o Rastrigin em 2D</p>
                                            <p className="text-sm text-white/40">Cores quentes = valores altos | Cores frias = valores baixos</p>
                                        </div>
                                    )}

                                    {/* Contour lines */}
                                    {slidesData[slideIdx].type === 'contour' && (
                                        <div className="flex flex-col items-center">
                                            <RastriginMiniCanvas />
                                            <p className="mt-4 text-white/60">Visualiza√ß√£o das curvas de n√≠vel</p>
                                            <p className="text-sm text-white/40">O m√≠nimo global est√° no centro (0,0) = 0</p>
                                        </div>
                                    )}

                                    {/* AG Flowchart */}
                                    {slidesData[slideIdx].type === 'agflow' && <FlowchartAG labels={copy.flow} />}

                                    {/* PSO Equations */}
                                    {slidesData[slideIdx].type === 'psoequations' && <PSOEquations labels={copy.psoEq} />}

                                    {/* AG Simulation */}
                                    {slidesData[slideIdx].type === 'simAG' && (
                                        <div className="flex flex-col items-center">
                                            <RastriginMiniCanvas showAG={true} ag={ag} />
                                            <p className="mt-4 text-green-400">üß¨ Indiv√≠duos do AG (verde)</p>
                                            <p className="text-sm text-white/50">Gen: {ag.generation} | Best Fitness: {ag.bestFitness.toFixed(6)}</p>
                                        </div>
                                    )}

                                    {/* PSO Simulation */}
                                    {slidesData[slideIdx].type === 'simPSO' && (
                                        <div className="flex flex-col items-center">
                                            <RastriginMiniCanvas showPSO={true} pso={pso} />
                                            <p className="mt-4 text-orange-400">üê¶ Part√≠culas do PSO (laranja)</p>
                                            <p className="text-sm text-white/50">Iter: {pso.iteration} | Best Fitness: {pso.gBestFit.toFixed(6)}</p>
                                        </div>
                                    )}

                                    {/* Convergence Chart */}
                                    {slidesData[slideIdx].type === 'convergence' && (
                                        <div className="w-full">
                                            <ResponsiveContainer width="100%" height={300}>
                                                <LineChart data={chartData}>
                                                    <CartesianGrid strokeDasharray="3 3" stroke="#444" />
                                                    <XAxis dataKey="gen" stroke="#888" label={{ value: t('iterationLabel'), position: 'insideBottom', offset: -5 }} />
                                                    <YAxis stroke="#888" label={{ value: t('fitnessLabel'), angle: -90, position: 'insideLeft' }} />
                                                    <Tooltip contentStyle={{ background: '#1a1a2e', border: 'none' }} />
                                                    <Legend />
                                                    <Line type="monotone" dataKey="AG" stroke="#22c55e" dot={false} strokeWidth={2} />
                                                    <Line type="monotone" dataKey="PSO" stroke="#f97316" dot={false} strokeWidth={2} />
                                                </LineChart>
                                            </ResponsiveContainer>
                                            <p className="text-sm text-white/50 mt-2">{t('convergenceHint')}</p>
                                        </div>
                                    )}

                                    {/* Comparison Table */}
                                    {slidesData[slideIdx].type === 'comparison' && <ComparisonTable labels={copy.comparison} />}

                                    {/* Results */}
                                    {slidesData[slideIdx].type === 'results' && <ResultsChart labels={copy.results} />}
                                </div>
                                <div className="flex justify-between mt-8">
                                    <button onClick={() => setSlideIdx(Math.max(0, slideIdx - 1))} disabled={slideIdx === 0}
                                        className="px-6 py-2 rounded-lg bg-emerald-600 disabled:opacity-30">‚Üê Anterior</button>
                                    <span className="text-white/50">{slideIdx + 1} / {slidesData.length}</span>
                                    <button onClick={() => setSlideIdx(Math.min(slidesData.length - 1, slideIdx + 1))} disabled={slideIdx === slidesData.length - 1}
                                        className="px-6 py-2 rounded-lg bg-emerald-600 disabled:opacity-30">Pr√≥ximo ‚Üí</button>
                                </div>
                            </div>
                        )}


                        {tab === 2 && (
                            <div className="glass rounded-2xl p-6 max-w-4xl mx-auto">
                                <h2 className="text-xl font-bold mb-6">{t('metaTitle')}</h2>
                                <div className="space-y-4">
                                    {metaPrompts.map((p, i) => (
                                        <div key={i} className={`p-4 rounded-xl ${p.role === 'User' ? 'bg-blue-900/30 ml-8' : 'bg-emerald-900/30 mr-8'}`}>
                                            <span className="text-xs font-bold text-white/50 uppercase">{p.role}</span>
                                            <p className="mt-1">{p.content}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        )}

                    </main>

                    <footer className="text-center mt-12 text-white/30 text-sm">
                        <p>{t('footer')}</p>
                    </footer>
                </div>
            );
        };

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>

</html>